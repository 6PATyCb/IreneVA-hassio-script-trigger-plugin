# Триггер скриптов Home Assistant
Плагин для [Ирины, голосового ассистента](https://github.com/janvarev/Irene-Voice-Assistant)

Данный плагин открывает огромные возможности для Ирины, позволяя запускать голосом скрипты в Home Assistant.

Запросы делаются по [REST API](https://developers.home-assistant.io/docs/api/rest/), благадоря чему отпадает надобность в перезапуске и Ирины и HA.

## Как использовать плагин
1. Скачайте репозиторий и положите папку plugins в директорию с репозиторием Ирины (или просто положите файл в plugins)
2. Получите "Долгосрочный токен доступа" / [long lived access token](https://developers.home-assistant.io/docs/auth_api/#long-lived-access-token) в своём профиле в Home Assistant
3. Откройте файл `plugin_hassio_script_trigger.py` в текстовом редакторе
4. Замените ссылку напротив `hassio_url` на ссылку вашего Home Assistant, обратите внимание - в конце должен быть символ `/`
5. Впишите ваш токен из пункта 2 напротив `hassio_key`

## Принцип работы
- После получения одной из команд плагина, в API вашего HA запрашивается список всех доступных сервисов, из этого списка выбираются только скрипты.
- В списке скриптов плагин ищет совпадения фразы и алиасу скрипта (HA позволяет давать названия скриптам на кириллице).
- Если скрипт нашёлся - делается запрос на его выполнение по "ID объекта"
- Бонусом Ирина озвучит текст из описания в специальном формате - `ttsreply(текст)` (для добавления описания к скрипту придется открыть текстовый редактор)

## Примеры команд и скриптов
1. Вы говорите "ирина хочу спать"

>Скрипт выключает весь свет, в спальне включает ночник и устанавливает комфортную температуру, жалюзи закрываются, ассистент желает вам приятных снов

2. Вы говорите "ирина я буду собиратся на работу"

>Скрипт присылает вам на телефон прогноз погоды и примерное время пути, термостат отключается, включается чайник на кухне, ассистент желает  продуктивного дня

2. Вы говорите "ирина сделай свет ярче"

>Жалюзи открываются, включается свет
